<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Old content, ignore | DSC 106</title><meta name="generator" content="Jekyll v3.9.0" /><meta property="og:title" content="Old content, ignore" /><meta name="author" content="Sam Lau" /><meta property="og:locale" content="en_US" /><meta name="description" content="DSC 106, Winter 2025 at UC San Diego" /><meta property="og:description" content="DSC 106, Winter 2025 at UC San Diego" /><link rel="canonical" href="http://localhost:4000/labs/lab07/old/" /><meta property="og:url" content="http://localhost:4000/labs/lab07/old/" /><meta property="og:site_name" content="DSC 106" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Old content, ignore" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Sam Lau"},"description":"DSC 106, Winter 2025 at UC San Diego","headline":"Old content, ignore","url":"http://localhost:4000/labs/lab07/old/"}</script> <script type="module" src="/assets/global.js"></script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="/" class="site-title lh-tight"> DSC 106 </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">🏠 Home</a><li class="nav-list-item"><a href="/syllabus/" class="nav-list-link">📖 Syllabus</a><li class="nav-list-item"><a href="/calendar/" class="nav-list-link">📆 Calendar</a><li class="nav-list-item"><a href="/tech_support/" class="nav-list-link">🙋‍♂️ Tech Support</a><li class="nav-list-item"><a href="/resources/" class="nav-list-link">📚 Resources</a><li class="nav-list-item"><a href="/staff/" class="nav-list-link">👩‍🏫 Staff</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in 👩‍🔬 Programming Labs category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/labs/" class="nav-list-link">👩‍🔬 Programming Labs</a><ul class="nav-list "><li class="nav-list-item "><a href="/labs/debugging/" class="nav-list-link">Help Us Help You: Things to try before asking for help</a><li class="nav-list-item "><a href="/labs/lab00/" class="nav-list-link">Lab 0: Setup</a><li class="nav-list-item "><a href="/labs/lab01/" class="nav-list-link">Lab 1: Introduction to the Web platform</a><li class="nav-list-item "><a href="/labs/lab02/" class="nav-list-link">Lab 2: Styling with CSS</a><li class="nav-list-item "><a href="/labs/lab03/" class="nav-list-link">Lab 3: Introduction to JS</a><li class="nav-list-item "><a href="/labs/lab04/" class="nav-list-link">Lab 4: Svelte (Templating & Control Flow)</a><li class="nav-list-item "><a href="/labs/lab05/" class="nav-list-link">Lab 5: Svelte II (Loading Data & Reactivity)</a><li class="nav-list-item "><a href="/labs/lab06/" class="nav-list-link">Lab 6: Visualizing categorical data with D3</a><li class="nav-list-item "><a href="/labs/lab07/" class="nav-list-link">Lab 7: Visualizing quantitative data with D3</a><li class="nav-list-item "><a href="/labs/lab08/" class="nav-list-link">Lab 8: Geospatial Visualizations</a><li class="nav-list-item "><a href="/labs/lab09/" class="nav-list-link">Lab 9: Animation & Scrollytelling</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in 📝 Projects category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/projects/" class="nav-list-link">📝 Projects</a><ul class="nav-list "><li class="nav-list-item "><a href="/projects/final_project/" class="nav-list-link">Final Project</a><li class="nav-list-item "><a href="/projects/project1/" class="nav-list-link">Project 1: Expository Visualization</a><li class="nav-list-item "><a href="/projects/project2/" class="nav-list-link">Project 2: Deceptive Visualization</a><li class="nav-list-item "><a href="/projects/project2peer/" class="nav-list-link">Project 2: Deceptive Visualization - Peer Grading</a><li class="nav-list-item "><a href="/projects/project3/" class="nav-list-link">Project 3: Interactive Visualization</a><li class="nav-list-item "><a href="/projects/project3peer/" class="nav-list-link">Project 3: Interactive Visualization - Peer Grading</a></ul></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DSC 106" aria-label="Search DSC 106" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="" class="site-button" > 💻 GitHub </a><li class="aux-nav-list-item"> <a href="" class="site-button" > 🙋 Ed </a><li class="aux-nav-list-item"> <a href="" class="site-button" > 💯 Gradescope </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main"><h1 id="old-content-ignore"> <a href="#old-content-ignore" class="anchor-heading" aria-labelledby="old-content-ignore"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Old content, ignore</h1><h2 id="step-5-bar-plot-of-line-length-and-depth-by-line-number"> <a href="#step-5-bar-plot-of-line-length-and-depth-by-line-number" class="anchor-heading" aria-labelledby="step-5-bar-plot-of-line-length-and-depth-by-line-number"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Bar plot of line length and depth by line number</h2><p>Summary stats are nice, but it’s hard to get a good picture of the distribution of the data and any potential correlations.</p><p>Let’s try and figure out if there are any correlations between line number, depth, and index by visualizing them as a bar plot.</p><h3 id="step-41-basic-bar-chart-of-line-length-by-line-number"> <a href="#step-41-basic-bar-chart-of-line-length-by-line-number" class="anchor-heading" aria-labelledby="step-41-basic-bar-chart-of-line-length-by-line-number"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4.1: Basic bar chart of line length by line number</h3><p>First, let’s define a width and height for our coordinate space:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</code></pre></div></div><p>and an SVG to hold our chart:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;svg</span> <span class="na">viewBox=</span><span class="s">"0 {-height} {width} {height}"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- bars will go here --&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</code></pre></div></div><p>Note that we used a <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/viewBox"><code class="language-plaintext highlighter-rouge">viewBox</code></a> with a minimum Y coordinate of <code class="language-plaintext highlighter-rouge">{-height}</code> so that the bottom of the SVG is Y=0, which will make plotting easier.</p><p>Now, as shown in the <a href="https://vis-society.github.io/lectures/intro-svelte-d3.html">web-based visualization lecture</a>, we create scales to map our data to the coordinate space using the <a href="https://d3js.org/d3-scale/linear">d3-scale</a> module:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span>
  <span class="p">.</span><span class="nx">scaleBand</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">line</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">]);</span>

<span class="nl">$</span><span class="p">:</span> <span class="nx">yScale</span> <span class="o">=</span> <span class="nx">d3</span>
  <span class="p">.</span><span class="nx">scaleLinear</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">)])</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">height</span><span class="p">]);</span>
</code></pre></div></div><p>This will allow us to draw bars inside our <code class="language-plaintext highlighter-rouge">&lt;svg&gt;</code> in a pretty straightforward way, without having to do the mapping calculations ourselves:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;svg</span> <span class="na">viewBox=</span><span class="s">"0 -{height} {width} {height}"</span><span class="nt">&gt;</span>
  {#each data as d, i}
  <span class="nt">&lt;rect</span>
    <span class="na">x=</span><span class="s">"{xScale(d.line)}"</span>
    <span class="na">width=</span><span class="s">"{xScale.bandwidth()}"</span>
    <span class="na">height=</span><span class="s">"{yScale(d.length)}"</span>
    <span class="na">fill=</span><span class="s">"steelblue"</span>
  <span class="nt">/&gt;</span>
  {/each}
<span class="nt">&lt;/svg&gt;</span>
</code></pre></div></div><p>At this point our chart looks like this:</p><p><img src="/labs/lab07/images/length-bar-chart-black.png" alt="alt text" /></p><p>Let’s add some style in a <code class="language-plaintext highlighter-rouge">&lt;style&gt;</code> element:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">svg</span> <span class="p">{</span>
	<span class="cm">/* Don’t clip content outside the &lt;svg&gt; element */</span>
	<span class="nl">overflow</span><span class="p">:</span> <span class="nx">visible</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">rect</span> <span class="p">{</span>
	<span class="cm">/* Flip bar vertically */</span>
	<span class="nl">transform</span><span class="p">:</span> <span class="nx">scaleY</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

	<span class="cm">/* Make bars semi-transparent to see overlap */</span>
	<span class="nx">fill</span><span class="o">-</span><span class="nx">opacity</span><span class="p">:</span> <span class="p">.</span><span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>The final result looks a bit like this (the exact shape will vary based on your data):</p><p><img src="images/length-bar-chart.png" alt="" class="outline" /></p><h3 id="step-42-shifting-the-bars-by-indentation-level"> <a href="#step-42-shifting-the-bars-by-indentation-level" class="anchor-heading" aria-labelledby="step-42-shifting-the-bars-by-indentation-level"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4.2: Shifting the bars by indentation level</h3><p>Even though our bars overlap, the overlap does not actually convey meaningful information, because the data points do not correspond to the actual position of the code in the line. To illustrate that, let’s shift the bars up by the depth of the line.</p><p>The result looks like this:</p><p><img src="images/length-depth-bar-plot.png" alt="" class="outline" /></p><h3 id="step-43-different-color-per-file-type"> <a href="#step-43-different-color-per-file-type" class="anchor-heading" aria-labelledby="step-43-different-color-per-file-type"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4.3: Different color per file type</h3><p>First, let’s reactively mutate the data to add a <code class="language-plaintext highlighter-rouge">type</code> property to each object, which will contain the file extension of the file the line is from.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">d</span> <span class="k">of</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">d</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">).</span><span class="nx">pop</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>Then let’s map the Tableau color scale to the file types, using <code class="language-plaintext highlighter-rouge">d3.scaleOrdinal()</code>:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="nx">colors</span> <span class="o">=</span> <span class="nx">d3</span>
  <span class="p">.</span><span class="nx">scaleOrdinal</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">schemeTableau10</span><span class="p">);</span>
</code></pre></div></div><p>and change the hardcoded <code class="language-plaintext highlighter-rouge">fill="steelblue"</code> with <code class="language-plaintext highlighter-rouge">fill={colors(d.type)}</code> in the <code class="language-plaintext highlighter-rouge">&lt;rect&gt;</code> element.</p><p>If we preview at this point, we’ll get something like this:</p><p><img src="/labs/lab07/images/bar-plot-colors-1.png" alt="alt text" /></p><p>This is because colors get randomly assigned to file types based on the order they appear in our dataset. Let’s change this and apply the colors in order starting from the file types with the most lines of code. First, we need to <em>count</em> the number of lines per file type:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="nx">typeStats</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span>
  <span class="nx">d3</span><span class="p">.</span><span class="nx">rollup</span><span class="p">(</span>
    <span class="nx">data</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
  <span class="p">),</span>
<span class="p">);</span>
</code></pre></div></div><p>this is a D3 <a href="https://d3js.org/d3-array/intern#InternMap"><code class="language-plaintext highlighter-rouge">InternMap</code></a>, which is similar to a JS <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code class="language-plaintext highlighter-rouge">Map</code></a>. You can see what data it contains by temporarily adding this line to your HTML:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{JSON.stringify(typeStats, null, "\t")}
</code></pre></div></div><p>in my case it printed:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "html": 15, "svelte": 403, "js": 93, "css": 93 }
</code></pre></div></div><p>Now let’s sort this map by value, using the <a href="https://d3js.org/d3-array/sort#sort"><code class="language-plaintext highlighter-rouge">d3.sort()</code></a> method from <code class="language-plaintext highlighter-rouge">d3-array</code>:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="nx">typeStats</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span>
  <span class="nx">d3</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span>
    <span class="nx">d3</span><span class="p">.</span><span class="nx">rollup</span><span class="p">(</span>
      <span class="nx">data</span><span class="p">,</span>
      <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="p">(</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">descending</span><span class="p">(</span><span class="nx">d1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">d2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
  <span class="p">),</span>
<span class="p">);</span>
</code></pre></div></div><p>At this point it may be clearer to use a statement block:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">typeStats</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nl">$</span><span class="p">:</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">stats</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">rollup</span><span class="p">(</span>
    <span class="nx">data</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
  <span class="p">);</span>
  <span class="kd">let</span> <span class="nx">sortedStats</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">stats</span><span class="p">,</span> <span class="p">(</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">descending</span><span class="p">(</span><span class="nx">d1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">d2</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
  <span class="nx">typeStats</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">fromEntries</span><span class="p">(</span><span class="nx">sortedStats</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>The output should have now changed. In my case it was:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "svelte": 403, "js": 93, "css": 93, "html": 15 }
</code></pre></div></div><p>Now instead of mapping our raw data to the color scale, let’s map the keys of this map, by replacing <code class="language-plaintext highlighter-rouge">data.map(d =&gt; d.type)</code> with <code class="language-plaintext highlighter-rouge">Object.keys(typeStats)</code> in the <code class="language-plaintext highlighter-rouge">colors</code> scale definition:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">:</span> <span class="nx">colors</span> <span class="o">=</span> <span class="nx">d3</span>
  <span class="p">.</span><span class="nx">scaleOrdinal</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">typeStats</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">d3</span><span class="p">.</span><span class="nx">schemeTableau10</span><span class="p">);</span>
</code></pre></div></div><p>We should be seeing something like this:</p><p><img src="/labs/lab07/images/bar-plot-colors-2.png" alt="" /></p><h3 id="step-5-adding-a-tooltip"> <a href="#step-5-adding-a-tooltip" class="anchor-heading" aria-labelledby="step-5-adding-a-tooltip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Adding a tooltip</h3><p>There’s a lot going on in our chart, and it’s a little hard to process. It may be helpful to be able to see the exact data each bar represents by hovering over it and seeing the data that corresponds to the data point hovered.</p></div></div><div class="search-overlay"></div></div>
